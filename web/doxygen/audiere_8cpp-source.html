<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>audiere.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body bgcolor="#ffffff">
<!-- Generated by Doxygen 1.2.8.1 -->
<center>
<a class="qindex" href="main.html">Main Page</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>audiere.cpp</h1><a href="audiere_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <font class="preprocessor">#include &lt;string&gt;</font>
00002 <font class="preprocessor">#include &lt;string.h&gt;</font>
00003 <font class="preprocessor">#include &lt;ctype.h&gt;</font>
00004 <font class="preprocessor">#include "<a class="code" href="audiere_8h.html">audiere.h</a>"</font>
00005 <font class="preprocessor">#include "<a class="code" href="context_8hpp.html">context.hpp</a>"</font>
00006 <font class="preprocessor">#include "<a class="code" href="default__file_8hpp.html">default_file.hpp</a>"</font>
00007 <font class="preprocessor">#include "<a class="code" href="stream_8hpp.html">stream.hpp</a>"</font>
00008 <font class="preprocessor">#include "<a class="code" href="file_8hpp.html">file.hpp</a>"</font>
00009 
00010 
<a name="l00011"></a><a class="code" href="audiere_8cpp.html#a0">00011</a> <font class="keyword">inline</font> <a class="code" href="classContext.html">Context</a>* <a class="code" href="audiere_8cpp.html#a0">ImportContext</a>(ADR_CONTEXT c)<font class="keyword"> </font>{ <font class="keywordflow">return</font> reinterpret_cast&lt;Context*&gt;(c); }
<a name="l00012"></a><a class="code" href="audiere_8cpp.html#a1">00012</a> <font class="keyword">inline</font> <a class="code" href="classStream.html">Stream</a>*  <a class="code" href="audiere_8cpp.html#a1">ImportStream</a>(ADR_STREAM s)<font class="keyword">   </font>{ <font class="keywordflow">return</font> reinterpret_cast&lt;Stream*&gt;(s);  }
<a name="l00013"></a><a class="code" href="audiere_8cpp.html#a2">00013</a> <font class="keyword">inline</font> ADR_CONTEXT <a class="code" href="audiere_8cpp.html#a2">ExportContext</a>(<a class="code" href="classContext.html">Context</a>* c)<font class="keyword"> </font>{ <font class="keywordflow">return</font> reinterpret_cast&lt;ADR_CONTEXT&gt;(c); }
<a name="l00014"></a><a class="code" href="audiere_8cpp.html#a3">00014</a> <font class="keyword">inline</font> ADR_STREAM  <a class="code" href="audiere_8cpp.html#a3">ExportStream</a>(<a class="code" href="classStream.html">Stream</a>* s)<font class="keyword">   </font>{ <font class="keywordflow">return</font> reinterpret_cast&lt;ADR_STREAM&gt;(s);  }
00015 
00016 
00018 
<a name="l00019"></a><a class="code" href="audiere_8cpp.html#a18">00019</a> <font class="keyword">const</font> <font class="keywordtype">char</font>* ADR_CALL <a class="code" href="audiere_8cpp.html#a4">AdrGetVersion</a>()<font class="keyword"></font>
00020 <font class="keyword"></font>{
00021   <font class="keywordflow">return</font> <font class="stringliteral">"1.0.4"</font>;
00022 }
00023 
00025 
<a name="l00026"></a><a class="code" href="audiere_8cpp.html#a19">00026</a> <a class="code" href="structADR__CONTEXT__ATTRimp.html">ADR_CONTEXT_ATTR</a> ADR_CALL <a class="code" href="audiere_8cpp.html#a5">AdrCreateContextAttr</a>()<font class="keyword"></font>
00027 <font class="keyword"></font>{
00028   <a class="code" href="structADR__CONTEXT__ATTRimp.html">ADR_CONTEXT_ATTR</a> attr = <font class="keyword">new</font> <a class="code" href="structADR__CONTEXT__ATTRimp.html">ADR_CONTEXT_ATTRimp</a>;
00029   attr-&gt;output_device = <font class="stringliteral">""</font>;
00030   attr-&gt;parameters    = <font class="stringliteral">""</font>;
00031   attr-&gt;opaque        = 0;
00032   attr-&gt;open          = DefaultFileOpen;
00033   attr-&gt;close         = DefaultFileClose;
00034   attr-&gt;read          = DefaultFileRead;
00035   attr-&gt;seek          = DefaultFileSeek;
00036   attr-&gt;tell          = DefaultFileTell;
00037   <font class="keywordflow">return</font> attr;
00038 }
00039 
00041 
<a name="l00042"></a><a class="code" href="audiere_8cpp.html#a20">00042</a> <font class="keywordtype">void</font> ADR_CALL <a class="code" href="audiere_8h.html#a20">AdrDestroyContextAttr</a>(
00043   <a class="code" href="structADR__CONTEXT__ATTRimp.html">ADR_CONTEXT_ATTR</a> attr)<font class="keyword"></font>
00044 <font class="keyword"></font>{
00045   <font class="keyword">delete</font> attr;
00046 }
00047 
00049 
<a name="l00050"></a><a class="code" href="audiere_8cpp.html#a21">00050</a> <font class="keywordtype">void</font> ADR_CALL <a class="code" href="audiere_8h.html#a21">AdrContextAttrSetOutputDevice</a>(
00051   <a class="code" href="structADR__CONTEXT__ATTRimp.html">ADR_CONTEXT_ATTR</a> attr,
00052   <font class="keyword">const</font> <font class="keywordtype">char</font>* output_device)<font class="keyword"></font>
00053 <font class="keyword"></font>{
00054   attr-&gt;output_device = output_device;
00055 }
00056 
00058 
<a name="l00059"></a><a class="code" href="audiere_8cpp.html#a22">00059</a> <font class="keywordtype">void</font> ADR_CALL <a class="code" href="audiere_8h.html#a22">AdrContextAttrSetParameters</a>(
00060   <a class="code" href="structADR__CONTEXT__ATTRimp.html">ADR_CONTEXT_ATTR</a> attr,
00061   <font class="keyword">const</font> <font class="keywordtype">char</font>* parameters)<font class="keyword"></font>
00062 <font class="keyword"></font>{
00063   attr-&gt;parameters = parameters;
00064 }
00065 
00067 
<a name="l00068"></a><a class="code" href="audiere_8cpp.html#a23">00068</a> <font class="keywordtype">void</font> ADR_CALL <a class="code" href="audiere_8h.html#a23">AdrContextAttrSetOpaque</a>(
00069   <a class="code" href="structADR__CONTEXT__ATTRimp.html">ADR_CONTEXT_ATTR</a> attr,
00070   <font class="keywordtype">void</font>* opaque)<font class="keyword"></font>
00071 <font class="keyword"></font>{
00072   attr-&gt;opaque = opaque;
00073 }
00074 
00076 
<a name="l00077"></a><a class="code" href="audiere_8cpp.html#a24">00077</a> <font class="keywordtype">void</font> ADR_CALL <a class="code" href="audiere_8h.html#a24">AdrContextAttrSetFileCallbacks</a>(
00078   <a class="code" href="structADR__CONTEXT__ATTRimp.html">ADR_CONTEXT_ATTR</a> attr,
00079   ADR_FILE_OPEN  open,
00080   ADR_FILE_CLOSE close,
00081   ADR_FILE_READ  read,
00082   ADR_FILE_SEEK  seek,
00083   ADR_FILE_TELL  tell)<font class="keyword"></font>
00084 <font class="keyword"></font>{
00085   <font class="keywordflow">if</font> (!open || !close || !read || !seek || !tell) {
00086     attr-&gt;open  = DefaultFileOpen;
00087     attr-&gt;close = DefaultFileClose;
00088     attr-&gt;read  = DefaultFileRead;
00089     attr-&gt;seek  = DefaultFileSeek;
00090     attr-&gt;tell  = DefaultFileTell;
00091   } <font class="keywordflow">else</font> {
00092     attr-&gt;open  = open;
00093     attr-&gt;close = close;
00094     attr-&gt;read  = read;
00095     attr-&gt;seek  = seek;
00096     attr-&gt;tell  = tell;
00097   }
00098 }
00099 
00101 
<a name="l00102"></a><a class="code" href="audiere_8cpp.html#a25">00102</a> ADR_CONTEXT ADR_CALL <a class="code" href="audiere_8h.html#a25">AdrCreateContext</a>(<a class="code" href="structADR__CONTEXT__ATTRimp.html">ADR_CONTEXT_ATTR</a> attr)<font class="keyword"></font>
00103 <font class="keyword"></font>{
00104   <a class="code" href="debug_8hpp.html#a1">ADR_GUARD</a>(<font class="stringliteral">"AdrCreateContext"</font>);
00105 
00106   <a class="code" href="structADR__CONTEXT__ATTRimp.html">ADR_CONTEXT_ATTR</a> delete_attr = 0;
00107   <font class="keywordflow">if</font> (!attr) {
00108     delete_attr = <a class="code" href="audiere_8cpp.html#a5">AdrCreateContextAttr</a>();
00109     attr = delete_attr;
00110   }
00111 
00112   <font class="comment">// the context always consumes the filesystem in some way or another,</font>
00113   <font class="comment">// so we don't have to worry about cleaning it up</font>
00114   <a class="code" href="classIFileSystem.html">IFileSystem</a>* fs = <font class="keyword">new</font> ADRFileSystem(
00115     attr-&gt;opaque,
00116     attr-&gt;open,
00117     attr-&gt;close,
00118     attr-&gt;read,
00119     attr-&gt;seek,
00120     attr-&gt;tell);
00121 
00122   <a class="code" href="classContext.html">Context</a>* context = <a class="code" href="classContext.html#d0">Context::Create</a>(
00123     attr-&gt;output_device.c_str(),
00124     attr-&gt;parameters.c_str(),
00125     fs);
00126 
00127   <font class="keyword">delete</font> delete_attr;
00128   <font class="keywordflow">return</font> <a class="code" href="audiere_8cpp.html#a2">ExportContext</a>(context);
00129 }
00130 
00132 
<a name="l00133"></a><a class="code" href="audiere_8cpp.html#a26">00133</a> <font class="keywordtype">void</font> ADR_CALL <a class="code" href="audiere_8h.html#a26">AdrDestroyContext</a>(ADR_CONTEXT context)<font class="keyword"></font>
00134 <font class="keyword"></font>{
00135   <a class="code" href="debug_8hpp.html#a1">ADR_GUARD</a>(<font class="stringliteral">"AdrDestroyContext"</font>);
00136 
00137   <a class="code" href="audiere_8cpp.html#a0">ImportContext</a>(context)-&gt;Release();
00138   <a class="code" href="debug_8hpp.html#a2">ADR_LOG</a>(<font class="stringliteral">"done releasing context"</font>);
00139 }
00140 
00142 
<a name="l00143"></a><a class="code" href="audiere_8cpp.html#a27">00143</a> ADR_STREAM ADR_CALL <a class="code" href="audiere_8h.html#a27">AdrOpenStream</a>(ADR_CONTEXT context, <font class="keyword">const</font> <font class="keywordtype">char</font>* filename)<font class="keyword"></font>
00144 <font class="keyword"></font>{
00145   <a class="code" href="debug_8hpp.html#a1">ADR_GUARD</a>(<font class="stringliteral">"AdrOpenStream"</font>);
00146 
00147   <font class="keywordflow">return</font> <a class="code" href="audiere_8cpp.html#a3">ExportStream</a>(<a class="code" href="audiere_8cpp.html#a0">ImportContext</a>(context)-&gt;OpenStream(filename));
00148 }
00149 
00151 
<a name="l00152"></a><a class="code" href="audiere_8cpp.html#a28">00152</a> <font class="keywordtype">void</font> ADR_CALL <a class="code" href="audiere_8h.html#a28">AdrCloseStream</a>(ADR_STREAM stream)<font class="keyword"></font>
00153 <font class="keyword"></font>{
00154   <a class="code" href="debug_8hpp.html#a1">ADR_GUARD</a>(<font class="stringliteral">"AdrCloseStream"</font>);
00155 
00156   <font class="keyword">delete</font> <a class="code" href="audiere_8cpp.html#a1">ImportStream</a>(stream);
00157 }
00158 
00160 
<a name="l00161"></a><a class="code" href="audiere_8cpp.html#a29">00161</a> <font class="keywordtype">void</font> ADR_CALL <a class="code" href="audiere_8h.html#a29">AdrPlayStream</a>(ADR_STREAM stream)<font class="keyword"></font>
00162 <font class="keyword"></font>{
00163   <a class="code" href="debug_8hpp.html#a1">ADR_GUARD</a>(<font class="stringliteral">"AdrPlayStream"</font>);
00164 
00165   <a class="code" href="audiere_8cpp.html#a1">ImportStream</a>(stream)-&gt;Play();
00166 }
00167 
00169 
<a name="l00170"></a><a class="code" href="audiere_8cpp.html#a30">00170</a> <font class="keywordtype">void</font> ADR_CALL <a class="code" href="audiere_8h.html#a30">AdrPauseStream</a>(ADR_STREAM stream)<font class="keyword"></font>
00171 <font class="keyword"></font>{
00172   <a class="code" href="debug_8hpp.html#a1">ADR_GUARD</a>(<font class="stringliteral">"AdrPauseStream"</font>);
00173   
00174   <a class="code" href="audiere_8cpp.html#a1">ImportStream</a>(stream)-&gt;Pause();
00175 }
00176 
00178 
<a name="l00179"></a><a class="code" href="audiere_8cpp.html#a31">00179</a> <font class="keywordtype">void</font> ADR_CALL <a class="code" href="audiere_8h.html#a31">AdrResetStream</a>(ADR_STREAM stream)<font class="keyword"></font>
00180 <font class="keyword"></font>{
00181   <a class="code" href="debug_8hpp.html#a1">ADR_GUARD</a>(<font class="stringliteral">"AdrResetStream"</font>);
00182 
00183   <a class="code" href="audiere_8cpp.html#a1">ImportStream</a>(stream)-&gt;Reset();
00184 }
00185 
00187 
<a name="l00188"></a><a class="code" href="audiere_8cpp.html#a32">00188</a> ADR_BOOL ADR_CALL <a class="code" href="audiere_8h.html#a32">AdrIsStreamPlaying</a>(ADR_STREAM stream)<font class="keyword"></font>
00189 <font class="keyword"></font>{
00190   <a class="code" href="debug_8hpp.html#a1">ADR_GUARD</a>(<font class="stringliteral">"AdrIsStreamPlaying"</font>);
00191 
00192   <font class="keywordflow">return</font> <a class="code" href="audiere_8cpp.html#a1">ImportStream</a>(stream)-&gt;IsPlaying() ? ADR_TRUE : ADR_FALSE;
00193 }
00194 
00196 
<a name="l00197"></a><a class="code" href="audiere_8cpp.html#a33">00197</a> <font class="keywordtype">void</font> ADR_CALL <a class="code" href="audiere_8h.html#a33">AdrSetStreamRepeat</a>(ADR_STREAM stream, ADR_BOOL repeat)<font class="keyword"></font>
00198 <font class="keyword"></font>{
00199   <a class="code" href="debug_8hpp.html#a1">ADR_GUARD</a>(<font class="stringliteral">"AdrSetStreamRepeat"</font>);
00200 
00201   <a class="code" href="audiere_8cpp.html#a1">ImportStream</a>(stream)-&gt;SetRepeat(repeat == ADR_TRUE);
00202 }
00203 
00205 
<a name="l00206"></a><a class="code" href="audiere_8cpp.html#a34">00206</a> ADR_BOOL ADR_CALL <a class="code" href="audiere_8h.html#a34">AdrGetStreamRepeat</a>(ADR_STREAM stream)<font class="keyword"></font>
00207 <font class="keyword"></font>{
00208   <a class="code" href="debug_8hpp.html#a1">ADR_GUARD</a>(<font class="stringliteral">"AdrGetStreamRepeat"</font>);
00209 
00210   <font class="keywordflow">return</font> <a class="code" href="audiere_8cpp.html#a1">ImportStream</a>(stream)-&gt;IsRepeating() ? ADR_TRUE : ADR_FALSE;
00211 }
00212 
00214 
<a name="l00215"></a><a class="code" href="audiere_8cpp.html#a35">00215</a> <font class="keywordtype">void</font> ADR_CALL <a class="code" href="audiere_8h.html#a35">AdrSetStreamVolume</a>(ADR_STREAM stream, <font class="keywordtype">int</font> volume)<font class="keyword"></font>
00216 <font class="keyword"></font>{
00217   <a class="code" href="debug_8hpp.html#a1">ADR_GUARD</a>(<font class="stringliteral">"AdrSetStreamVolume"</font>);
00218 
00219   <font class="comment">// make sure the volume is within a valid range</font>
00220   <font class="keywordflow">if</font> (volume &lt; ADR_VOLUME_MIN) {
00221     volume = ADR_VOLUME_MIN;
00222   } <font class="keywordflow">else</font> <font class="keywordflow">if</font> (volume &gt; ADR_VOLUME_MAX) {
00223     volume = ADR_VOLUME_MAX;
00224   }
00225 
00226   <a class="code" href="audiere_8cpp.html#a1">ImportStream</a>(stream)-&gt;SetVolume(volume);
00227 }
00228 
00230 
<a name="l00231"></a><a class="code" href="audiere_8cpp.html#a36">00231</a> <font class="keywordtype">int</font> ADR_CALL <a class="code" href="audiere_8h.html#a36">AdrGetStreamVolume</a>(ADR_STREAM stream)<font class="keyword"></font>
00232 <font class="keyword"></font>{
00233   <a class="code" href="debug_8hpp.html#a1">ADR_GUARD</a>(<font class="stringliteral">"AdrGetStreamVolume"</font>);
00234 
00235   <font class="keywordflow">return</font> <a class="code" href="audiere_8cpp.html#a1">ImportStream</a>(stream)-&gt;GetVolume();
00236 }
00237 
</pre></div><hr><address><small>Generated at Mon Jun 10 02:55:12 2002 for audiere by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.gif" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.8.1 written by <a href="mailto:dimitri@stack.nl">Dimitri van Heesch</a>,
 &copy;&nbsp;1997-2001</small></address>
</body>
</html>

import os

Import('base_env PREFIX')

sources = Split("""
    debug
    device
    device_al
    device_mixer
    device_null
    file_ansi
    input
    input_mp3
    input_ogg
    input_wav
    noise
    repeatable
    resampler
    sample_buffer
    sound_effect
    square_wave
    sound
    threads_posix
    timer_posix
    tone
    utility
    version
""")

mpegsound_sources = Split("""
    bitwindow
    fileinput
    filter
    filter_2
    huffmantable
    mpeglayer1
    mpeglayer2
    mpeglayer3
    mpegtable
    mpegtoraw
    soundinputstream
    soundplayer
""")

sources = map(lambda n: n + '.cpp', sources)
sources.extend(map(lambda n: 'mpegsound/' + n + '.cpp', mpegsound_sources))

env = base_env.Copy()
env['CPPPATH'].append('mpegsound')
target = env.Library('audiere', sources)

env.Install(os.path.join(PREFIX, 'include'), 'audiere.h')
env.Install(os.path.join(PREFIX, 'lib32'), target)
